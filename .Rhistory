prev_index = cs_nrlevels[i]}
dim(betas_attr)
dim(betas_non_ref)
dim(betas_ref)
dim(beta_ref)
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
betas_per_attribute = c()
within_attribute_beta_comparisons = list()
# i=2
# prev_index =2
for(i in 1:length(nr_levels)){
print(i)
print(prev_index)
print(cs_nrlevels[i])
print(reduced_nr_levels[i])
betas_non_ref = avg_betas_draws[(prev_index):(cs_nrlevels[i]-i),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
betas_per_attribute = c()
within_attribute_beta_comparisons = list()
# i=2
# prev_index =2
for(i in 1:length(nr_levels)){
print(i)
print(prev_index)
print(cs_nrlevels[i])
print(reduced_nr_levels[i])
betas_non_ref = avg_betas_draws[(prev_r_index):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
betas_per_attribute = c()
within_attribute_beta_comparisons = list()
# i=2
# prev_index =2
for(i in 1:length(nr_levels)){
print(i)
print(prev_index)
print(cs_nrlevels[i])
print(reduced_nr_levels[i])
betas_non_ref = avg_betas_draws[(prev_r_index):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
betas_per_attribute = c()
within_attribute_beta_comparisons = list()
# i=2
# prev_index =2
for(i in 1:length(nr_levels)){
print(i)
print(prev_index)
print(cs_nrlevels[i])
print(reduced_nr_levels[i])
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
betas_per_attribute = c()
within_attribute_beta_comparisons = list()
# i=2
# prev_index =2
for(i in 1:length(nr_levels)){
# print(i)
# print(prev_index)
# print(cs_nrlevels[i])
# print(reduced_nr_levels[i])
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
print(comparisons)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
within_attribute_beta_comparisons
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
within_attribute_beta_comparisons = list()
for(i in 1:length(nr_levels)){
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
percen = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
if(percen < 50){
percen = 100 - percen
within_attribute_beta_comparisons[paste(comp[2], ">", comp[1])] = percen
}else{
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = percen
}}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
within_attribute_beta_comparisons
data.frame(within_attribute_beta_comparisons)
data.frame(within_attribute_beta_comparisons)
t(data.frame(within_attribute_beta_comparisons))
names(within_attribute_beta_comparisons))
names(within_attribute_beta_comparisons)
within_attribute_beta_comparisons = data.frame(matrix(ncol = 1, nrow = 0)
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
within_attribute_beta_comparisons = data.frame(matrix(ncol = 1, nrow = 0)
for(i in 1:length(nr_levels)){
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
percen = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
if(percen < 50){
percen = 100 - percen
within_attribute_beta_comparisons[paste(comp[2], ">", comp[1])] = percen
}else{
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = percen
}}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
within_attribute_beta_comparisons = data.frame(matrix(ncol = 1, nrow = 0))
for(i in 1:length(nr_levels)){
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
percen = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
if(percen < 50){
percen = 100 - percen
within_attribute_beta_comparisons[paste(comp[2], ">", comp[1])] = percen
}else{
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = percen
}}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
within_attribute_beta_comparisons = data.frame(matrix(ncol = 0, nrow = 1))
for(i in 1:length(nr_levels)){
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
percen = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
if(percen < 50){
percen = 100 - percen
within_attribute_beta_comparisons[paste(comp[2], ">", comp[1])] = percen
}else{
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = percen
}}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
within_attribute_beta_comparisons
t(within_attribute_beta_comparisons)
prev_index = 1
prev_r_index = 0
reduced_nr_levels = cumsum(nr_levels -1)
cs_nrlevels = cumsum(nr_levels)
within_attribute_beta_comparisons = data.frame(matrix(ncol = 0, nrow = 1))
for(i in 1:length(nr_levels)){
betas_non_ref = avg_betas_draws[(prev_r_index+1):(reduced_nr_levels[i]),] #2, 3500
if((prev_r_index+1)==reduced_nr_levels[i]){
beta_ref =  0 - betas_non_ref                                       #3500
}else{
beta_ref = 0 - apply(betas_non_ref,2,sum)}
betas_attr = rbind(betas_non_ref, beta_ref )
start = ifelse(i == 1, 1, cs_nrlevels[i-1]+1)
rownames(betas_attr) = all_levels[start:(cs_nrlevels[i])]
comparisons = combn(rownames(betas_attr), 2)
for(c in 1:ncol(comparisons)){
comp = comparisons[,c]
percen = round(sum(betas_attr[comp[1],] > betas_attr[comp[2],])/ncol(betas_attr) *100, 1)
if(percen < 50){
percen = 100 - percen
within_attribute_beta_comparisons[paste(comp[2], ">", comp[1])] = paste0(percen, "%")
}else{
within_attribute_beta_comparisons[paste(comp[1], ">", comp[2])] = paste0(percen, "%")
}}
prev_r_index = reduced_nr_levels[i]
prev_index = cs_nrlevels[i]}
within_attribute_beta_comparisons = t(within_attribute_beta_comparisons)
within_attribute_beta_comparisons
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages("DoE.base")
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
library(DoE.base)
oa.design(factor.names = list(c("as","abb", "ssd"), c("fsf", "fgfg", "fdfdf"), c("opop", "oii")))
mtcars
d = mtcars[1:3,1:3]
oa.design(factor.names = list(d)
)
d
as.list(d)
oa.design(factor.names = as.list(d))
l = as.list(d)
l = as.list(d[d!=4])
l
l = as.list(d)
removeListElemComplete = function(inlist, elem_remove) {
outlist = lapply(inlist, removeListElem, elem_remove = elem_remove)
outlist[lengths(outlist) > 0]
}
removeListElemComplete(l, 6)
removeListElem <- function(inlist,elem_remove){
outlist = lapply(inlist,setdiff,elem_remove)
outlist[lengths(outlist) > 0]
}
removeListElemComplete(l, 6)
l
k = removeListElemComplete(l, 6)
k
unlist(k)
dim(k)
length(k)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
load("designchecks.Rdata")
test = data.frame(matrix(data = "val", nrow = 5, ncol = 4))
test[4:5,3] = NA
test[4:5,1] = NA
current_and_alternative_designs(test)
load("designchecks.Rdata")
test = data.frame(matrix(data = "val", nrow = 5, ncol = 3))
test[4:5,3] = NA
test[3:5,1] = NA
current_and_alternative_designs(test)
test
test = data.frame(matrix(data = "val", nrow = 4, ncol = 3))
test[4,3] = NA
test[3:4,1] = NA
current_and_alternative_designs(test)
test
test = data.frame(matrix(data = "val", nrow = 4, ncol = 3))
test[4,3] = ""
test[3:4,1] = ""
current_and_alternative_designs(test)
dm_list = as.list(test)
dm_list = removeListElemComplete(dm_list, "")
ddd = oa.design(factor.names =  dm_list)
test
test = data.frame(matrix(data = 1:3, nrow = 4, ncol = 3))
test[4,3] = ""
test[3:4,1] = ""
test
current_and_alternative_designs(test)
dm_list = as.list(test)
dm_list = removeListElemComplete(dm_list, "")
ddd = oa.design(factor.names =  dm_list)
load("designchecks.Rdata")
test = data.frame(matrix(data = 1:4, nrow = 4, ncol = 3))
test[4,3] = ""
test[3:4,1] = ""
current_and_alternative_designs(test)
dm_list = as.list(test)
dm_list = removeListElemComplete(dm_list, "")
ddd = oa.design(factor.names =  dm_list)
ddd
rowSums(test=="")
colSums(test=="")
nrow(test) - colSums(test=="")
h = nrow(test) - colSums(test=="")
ddd = oa.design(nlevels =  h)
ddd
ddd = oa.design(nlevels =  c(5,5,5,5,5))
ddd
ddd = oa.design(nlevels =  c(3,4,2))
show.oas()
show.oas(show = "all")
ddd$type
attributes(ddd)
ddd$design.info$type
ddd$design.info
attributes(ddd)$design.info
attributes(ddd)$design.info$type
ddd = oa.design(nlevels =  c(4,4,2))
attributes(ddd)$design.info$type
ddd
ddd = oa.design(nlevels =  c(4,4,2), columns = "min3")
ddd
attributes(ddd)$design.info$type
ddd = oa.design(factor.names = dm_list, columns = "min3")
dm_list
attributes(ddd)$design.info$type
test
ddd = oa.design(nlevels = c(2,4,3))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
attributes(ddd)$design.info$type
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
shiny::runApp()
#install.packages('rsconnect')
library(rsconnect)
setwd("C:/Users/hannesrosenbusch/Documents/introducing conjoint")
rsconnect::setAccountInfo(name='rosenbusch',
token='AE3BBCC32B976AD16AA02B48CC7236DA',
secret='kBV5TmoWia6b4bk/kQGyy9sKghNVXz2f+3aBYiLx')
rsconnect::deployApp('conjoint app')
